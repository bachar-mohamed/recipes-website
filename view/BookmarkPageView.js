import view from "./view.js";

class BookmarkPageView extends view {
  _parent = document.querySelector("main");

  _generateMarkup() {
    return `
    <section class="bookmark_section">
        <h1 class="bookmark_title">Your Bookmarks</h1>
      <div class="bookmark_div_container">
        <div class="section_header">
          <div class="search_div">
            <input type="text" id="search_input" />
            <svg
              class="search_svg"
              xmlns="http://www.w3.org/2000/svg"
              version="1.1"
              viewBox="-5.0 -10.0 110.0 135.0"
            >
              <path
                d="m38.5 5c-18.5 0-33.5 15-33.5 33.5s15 33.5 33.5 33.5c7.9883 0 15.328-2.7969 21.086-7.4648l29.438 29.441c1.3672 1.3672 3.5859 1.3672 4.9531 0 1.3672-1.3672 1.3672-3.5859 0-4.9531l-29.441-29.438c4.668-5.7578 7.4648-13.098 7.4648-21.086 0-18.5-15-33.5-33.5-33.5zm-26.5 33.5c0-14.637 11.863-26.5 26.5-26.5s26.5 11.863 26.5 26.5-11.863 26.5-26.5 26.5-26.5-11.863-26.5-26.5z"
                fill-rule="evenodd"
              />
            </svg>
          </div>
          <div class="logout_div">
            <h1>logout</h1>
            <svg
              class="logout_svg"
              xmlns="http://www.w3.org/2000/svg"
              version="1.1"
              viewBox="-5.0 -10.0 110.0 135.0"
            >
              <path
                d="m7.4453 87.402 22.328 7.3359c0.50781 0.16797 1.043 0.25391 1.5781 0.25391 1.3477 0 2.6367-0.53516 3.5859-1.4844 0.95312-0.94922 1.4883-2.2383 1.4883-3.582v-3.0508c0.13281 0 0.25781 0.039062 0.39453 0.039062h20.938c2.7969-0.007812 5.0547-2.2812 5.0547-5.0781v-23.438h6.9297c0.21094 0 0.38281 0.17187 0.38281 0.38281v2.8828c-0.007812 1.9648 1.125 3.7578 2.9062 4.5859 0.68359 0.32422 1.4297 0.49219 2.1875 0.49219 1.1719-0.003907 2.3086-0.41406 3.2109-1.1602l14.203-11.672c1.168-0.96484 1.8477-2.3984 1.8477-3.918 0-1.5156-0.67969-2.9531-1.8477-3.9141l-14.203-11.668c-1.5156-1.25-3.6133-1.5117-5.3867-0.67188-1.7734 0.83594-2.9023 2.6211-2.9023 4.582v2.8867c0 0.10156-0.039063 0.19922-0.11328 0.26953-0.070313 0.070313-0.16797 0.10938-0.26953 0.10938h-6.9453v-23.438c-0.011719-2.793-2.2773-5.0508-5.0703-5.0547h-20.938c-0.13281 0-0.25781 0.027344-0.39453 0.039062l0.003906-3.0586c-0.003906-1.625-0.78125-3.1523-2.0977-4.1055-1.3203-0.94922-3.0117-1.2148-4.5586-0.70703l-22.312 7.332c-2.082 0.67969-3.4883 2.625-3.4844 4.8164v65.18c-0.007813 2.1914 1.4023 4.1328 3.4844 4.8125zm62.297-41.121c2.8008 0 5.0703-2.2695 5.0703-5.0703v-2.8828c-0.007812-0.14844 0.078125-0.28906 0.21875-0.34375 0.12891-0.078125 0.29688-0.058594 0.40234 0.050781l14.203 11.672c0.089843 0.070313 0.14062 0.17969 0.14062 0.29297s-0.050782 0.22266-0.14062 0.29297l-14.203 11.672c-0.10547 0.10547-0.27344 0.125-0.40234 0.050781-0.14062-0.054687-0.22656-0.19531-0.21875-0.34375v-2.8828c0-2.8008-2.2695-5.0703-5.0703-5.0703h-19.742c-0.21094 0-0.38281-0.17188-0.38281-0.38281v-6.6719c0-0.21094 0.17187-0.38281 0.38281-0.38281zm-33.305-28.125c0-0.21094 0.17188-0.38281 0.38281-0.38281h20.938c0.21094 0 0.37891 0.17187 0.37891 0.38281v23.438h-8.1367c-2.7969 0.003906-5.0664 2.2695-5.0703 5.0703v6.6758-0.003906c0.003906 2.8008 2.2734 5.0664 5.0703 5.0703h8.125v23.438c0 0.10156-0.039062 0.19922-0.11328 0.26953-0.070313 0.070313-0.16797 0.11328-0.26953 0.11328h-20.938c-0.21094 0-0.37891-0.17187-0.37891-0.38281zm-27.789-0.74609c-0.003907-0.16406 0.10547-0.3125 0.26172-0.35938l22.34-7.3398c0.039062-0.011719 0.082031-0.015626 0.125-0.015626 0.078125 0 0.15234 0.023438 0.21484 0.070313 0.10547 0.070313 0.16406 0.1875 0.16016 0.3125v79.848c0.003906 0.125-0.054688 0.24219-0.16016 0.3125-0.097656 0.070313-0.22266 0.09375-0.33984 0.050781l-22.344-7.3398c-0.15625-0.050781-0.26172-0.19531-0.25781-0.35938z"
              />
            </svg>
          </div>
        </div>
        <ul class="products-ul">
        ${this._data
          .map((info) => {
            return `
            <li class="bookmarked_recipe" data-id = ${info.id}>
            <div class="bookmarked_prod_img" style="background-image:url(${info.image_url})"></div>
            <div class="bookmarked_info">
              <h1>${info.title}</h1>
              <h3>${info.publisher}</h3>
            </div>
            <button class="delete_bookmark_btn">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                version="1.1"
                x="0px"
                y="0px"
                viewBox="0 0 72 90"
                style="enable-background: new 0 0 72 72"
                xml:space="preserve"
              >
                <path
                  d="M30,15.8134766h12c1.3808594,0,2.5-1.1191406,2.5-2.5s-1.1191406-2.5-2.5-2.5H30c-1.3808594,0-2.5,1.1191406-2.5,2.5  S28.6191406,15.8134766,30,15.8134766z"
                />
                <path
                  d="M56.5,18.9326172h-5h-31h-4c-1.3808594,0-2.5,1.1191406-2.5,2.5s1.1191406,2.5,2.5,2.5h1.6248169l1.7931519,34.8823242  c0.0683594,1.3291016,1.1660156,2.371582,2.4970703,2.371582h27.1699219c1.3310547,0,2.4287109-1.0424805,2.4970703-2.371582  l1.7931519-34.8823242H56.5c1.3808594,0,2.5-1.1191406,2.5-2.5S57.8808594,18.9326172,56.5,18.9326172z M33.032959,45.6650391  c0,1.3808594-1.1191406,2.5-2.5,2.5s-2.5-1.1191406-2.5-2.5v-12c0-1.3808594,1.1191406-2.5,2.5-2.5s2.5,1.1191406,2.5,2.5  V45.6650391z M43.967041,45.6650391c0,1.3808594-1.1191406,2.5-2.5,2.5s-2.5-1.1191406-2.5-2.5v-12  c0-1.3808594,1.1191406-2.5,2.5-2.5s2.5,1.1191406,2.5,2.5V45.6650391z"
                />
              </svg>
            </button>
          </li>
            `;
          })
          .join("")}
        </ul>
      </div>
      </section>
        `;
  }

  _searchInputHandler(handler) {
    const searchInput = this._parent.querySelector("#search_input");
    searchInput.addEventListener("input", (e) => {
      handler(e.target.value);
    });
  }

  _deleteBookMarkHandler(handler) {
    this._parent.addEventListener("click", (e) => {
      const trigger = e.target.closest(".delete_bookmark_btn");
      if (!trigger) return;
      const liParent = trigger.closest("li");
      handler(liParent.dataset.id);
    });
  }

  _recipeClickHandler(handler) {
    const recipe = this._parent.addEventListener("click", (e) => {
      if (
        e.target.closest(".delete_bookmark_btn") ||
        !e.target.closest(".bookmarked_recipe")
      )
        return;
      const trigger = e.target.closest(".bookmarked_recipe");
      handler(trigger.dataset.id, true);
    });
  }
}

export default new BookmarkPageView();
